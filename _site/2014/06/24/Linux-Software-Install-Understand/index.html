<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>深入理解软件包的配置、编译与安装</title>
    <meta name="description" content="说明：来自互联网，如有版权问题，请告知本人将其撤下。来源：http://works.jinbuguo.com/linux/understand_package_install.html前言从源代码安装过软件的朋友一定对 ./configure &amp;&amp; make &amp;&amp; make ins...">

    <link rel="shortcut icon" href="/favicon.ico?" type="image/x-icon">
    <link rel="icon" href="/favicon.ico?" type="image/x-icon">
    <link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://at.alicdn.com/t/font_8v3czwksspqlg14i.css">
    <link rel="stylesheet" href="/css/main.css ">
    <link rel="canonical" href="http://localhost:4000/2014/06/24/Linux-Software-Install-Understand/">
    <link rel="alternate" type="application/rss+xml" title="柯小小西" href="http://localhost:4000/feed.xml ">


    <script>
    // 百度统计代码
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?a9b0f47a0e50b02dafb8a7088436a9bc";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
    </script>




</head>


  <body>

    <header id="top">
    <div class="wrapper">
        <a href="/" class="brand">柯小小西</a>
        <small>留着一点点技术积蓄</small>
        <button id="headerMenu" class="menu"><i class="fa fa-bars"></i></button>
        <nav id="headerNav">
            <ul>
                <li>
                    
                    <a href="/">
                    
                        <i class="fa fa-home"></i>Home
                    </a>
                </li>

                
                    
                    <li>
                        
                        <a href="/archive/">
                        
                            <i class="fa fa-archive"></i>Archives
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/category/">
                        
                            <i class="fa fa-th-list"></i>Categories
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/tag/">
                        
                            <i class="fa fa-tags"></i>Tags
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/about/">
                        
                            <i class="fa fa-heart"></i>About
                        </a>
                    </li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
        </nav>
    </div>
</header>


        <div class="page clearfix" post>
    <div class="left">
        <h1>深入理解软件包的配置、编译与安装</h1>
        <div class="label">

            <div class="label-card">
                <i class="fa fa-calendar"></i>2014-06-24
            </div>

            <div class="label-card">
                
            </div>

            <div class="label-card">
                
            </div>

            <div class="label-card">
            


<!-- <span class="point">•</span> -->
<span class="categories">
  <i class="fa fa-th-list"></i>
  
    
        <a href="/category/#Linux" title="Category: Linux" rel="category">Linux</a>
    
  

  <!-- <span class="point">•</span> -->
</span>


            </div>

            <div class="label-card">
            
<!-- <span class="point">•</span> -->
<span class="pageTag">
  <i class="fa fa-tags"></i>
  
    
  

</span>

            </div>

        </div>
        <hr>
        <article itemscope itemtype="http://schema.org/BlogPosting">
        <p>说明：来自互联网，如有版权问题，请告知本人将其撤下。</p>

<p>来源：<a href="http://works.jinbuguo.com/linux/understand_package_install.htm">http://works.jinbuguo.com/linux/understand_package_install.htm</a>l</p>

<h2 id="前言"><a id="Intro">前言</a></h2>

<p>从源代码安装过软件的朋友一定对 <code class="highlighter-rouge">./configure &amp;&amp; make &amp;&amp; make install</code> 安装三步曲非常熟悉了。然而究竟这个过程中的每一步幕后都发生了些什么呢？本文将带领你一探究竟。深入理解这个过程将有助于你在LFS的基础上玩出自己的花样来。不过需要说明的是本文对 <code class="highlighter-rouge">Makefile</code> 和 <code class="highlighter-rouge">make</code> 的讲解是相当近视和粗浅的，但是对于理解安装过程来说足够了。</p>

<h2 id="概述"><a id="About">概述</a></h2>

<p>用一句话来解释这个过程就是：</p>

<p>根据源码包中 Makefile.in 文件的指示，configure 脚本检查当前的系统环境和配置选项，在当前目录中生成 <code class="highlighter-rouge">Makefile</code> 文件(还有其它本文无需关心的文件)，然后 <code class="highlighter-rouge">make</code> 程序就按照当前目录中的 Makefile 文件的指示将源代码编译为二进制文件，最后将这些二进制文件移动(即安装)到指定的地方(仍然按照 <code class="highlighter-rouge">Makefile</code> 文件的指示)。</p>

<p>由此可见 Makefile 文件是幕后的核心。要深入理解安装过程，必须首先对 <code class="highlighter-rouge">Makefile</code> 文件有充分的了解。本文将首先讲述 <code class="highlighter-rouge">Makefile</code> 与 <code class="highlighter-rouge">make</code> ，然后再讲述 <code class="highlighter-rouge">configure</code> 脚本。并且在讲述这两部分内容时，提供了尽可能详细的、可以运用于实践的参考资料。</p>

<h2 id="makefile-与-make"><a id="Make">Makefile 与 make</a></h2>

<p>用一句话来概括<code class="highlighter-rouge">Makefile</code> 与 <code class="highlighter-rouge">make</code> 的关系就是：</p>

<p><code class="highlighter-rouge">Makefile</code> 包含了所有的规则和目标，而 <code class="highlighter-rouge">make</code> 则是为了完成目标而去解释 <code class="highlighter-rouge">Makefiel</code> 规则的工具。</p>

<!-- more -->

<h3 id="make-语法">make 语法</h3>

<p>首先看看 <code class="highlighter-rouge">make</code> 的命令行语法：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
make <span class="o">[</span>options] <span class="o">[</span>targets] <span class="o">[</span><span class="nv">VAR</span><span class="o">=</span>VALUE]...

</code></pre></div></div>

<p><code class="highlighter-rouge">[options]</code>是命令行选项，可以用 <code class="highlighter-rouge">make --help</code> 命令查看全部，<code class="highlighter-rouge">[VAR=VALUE]</code>是在命令行上指定环境变量，这两个大家都很熟悉，将在稍后详细讲解。而<code class="highlighter-rouge">[targets]</code>是什么呢？字面的意思是”目标”，也就是希望本次 make 命令所完成的任务。凭经验猜测，这个<code class="highlighter-rouge">[targets]</code>大概可以用”check”,”install”之类(也就是常见的测试和安装命令)。但是它到底是个啥玩意儿？不带任何”目标”的 <code class="highlighter-rouge">make</code> 命令是什么意思？为什么在安装 LFS 工具链中的 Perl-5.8.8 软件包时会出现”make perl utilities”这样怪异的命令？要回答这些问题必须首先理解 <code class="highlighter-rouge">Makefile</code> 文件中的”规则”。</p>

<h3 id="makefile-规则">Makefile 规则</h3>

<p>Makefile 规则包含了文件之间的依赖关系和更新此规则目标所需要的命令。</p>

<p>一个简单的 Makefile 规则是这样写的：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
TARGET : PREREQUISITES
	COMMAND
TARGET

</code></pre></div></div>

<p>规则的目标。也就是可以被 make 使用的”目标”。有些目标可以没有依赖而只有动作(命令行)，比如”clean”，通常仅仅定义一系列删除中间文件的命令。同样，有些目标可以没有动作而只有依赖，比如”all”，通常仅仅用作”终极目标”。</p>

<p><code class="highlighter-rouge">PREREQUISITES</code><br />
规则的依赖。通常一个目标依赖于一个或者多个文件。</p>

<p><code class="highlighter-rouge">COMMAND</code><br />
规则的命令行。一个规则可以有零个或多个命令行。</p>

<p>OK! 现在你明白[targets]是什么了，原来它们来自于 <code class="highlighter-rouge">Makefile</code> 文件中一条条规则的目标(TARGET)。另外，<code class="highlighter-rouge">Makefile</code>文件中第一条规则的目标被称为”终极目标”，也就是你省略[targets]参数时的目标(通常为”all”)。</p>

<p>当你查看一个实际的 <code class="highlighter-rouge">Makefile</code> 文件时，你会发现有些规则非常复杂，但是它都符合规则的基本格式。此外，<code class="highlighter-rouge">Makefile</code> 文件中通常还包含了除规则以外的其它很多东西，不过本文只关心其中的变量。</p>

<h3 id="makefile-实例">Makefile 实例</h3>

<p>下面看一个简单的、实际的 <code class="highlighter-rouge">Makefile</code>文件：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="nv">CC</span><span class="o">=</span>gcc
<span class="nv">CPPFLAGS</span><span class="o">=</span>
<span class="nv">CFLAGS</span><span class="o">=</span><span class="nt">-O2</span> <span class="nt">-pipe</span>
<span class="nv">LDFLAGS</span><span class="o">=</span><span class="nt">-s</span>
<span class="nv">PREFIX</span><span class="o">=</span>/usr

all : prog1 prog2

prog1 : prog1.o
	<span class="k">$(</span>CC<span class="k">)</span> <span class="k">$(</span>LDFLAGS<span class="k">)</span> <span class="nt">-o</span> prog1 prog1.o

prog1.o : prog1.c
	<span class="k">$(</span>CC<span class="k">)</span> <span class="nt">-c</span> <span class="k">$(</span>CFLAGS<span class="k">)</span> prog1.c

prog2 : prog2.o
	<span class="k">$(</span>CC<span class="k">)</span> <span class="k">$(</span>CFLAGS<span class="k">)</span> <span class="k">$(</span>LDFLAGS<span class="k">)</span> <span class="nt">-o</span> prog2 prog2.o

prog2.o : prog2.c
	<span class="k">$(</span>CC<span class="k">)</span> <span class="nt">-c</span> <span class="k">$(</span>CPPFLAGS<span class="k">)</span> <span class="k">$(</span>CFLAGS<span class="k">)</span> prog2.c

clean :
	<span class="nb">rm</span> <span class="nt">-f</span> <span class="k">*</span>.<span class="o">{</span>o,a<span class="o">}</span> prog<span class="o">{</span>1,2<span class="o">}</span>

<span class="nb">install</span> : prog1 prog2
	<span class="k">if</span> <span class="o">(</span> <span class="nb">test</span> <span class="o">!</span> <span class="nt">-d</span> <span class="k">$(</span>PREFIX<span class="k">)</span>/bin <span class="o">)</span> <span class="p">;</span> <span class="k">then </span><span class="nb">mkdir</span> <span class="nt">-p</span> <span class="k">$(</span>PREFIX<span class="k">)</span>/bin <span class="p">;</span> <span class="k">fi
	</span><span class="nb">cp</span> <span class="nt">-f</span> prog1 <span class="k">$(</span>PREFIX<span class="k">)</span>/bin/prog1
	<span class="nb">cp</span> <span class="nt">-f</span> prog2 <span class="k">$(</span>PREFIX<span class="k">)</span>/bin/prog2

check <span class="nb">test</span> : prog1 prog2
	prog1 &lt; sample1.ref <span class="o">&gt;</span> sample1.rz
	prog1 &lt; sample2.ref <span class="o">&gt;</span> sample3.rz
	cmp sample1.ok sample1.rz
	cmp sample2.ok sample2.rz
	
</code></pre></div></div>

<p>从中可以看出，<code class="highlighter-rouge">make</code> 与 <code class="highlighter-rouge">make all</code> 以及 <code class="highlighter-rouge">make prog1 prog2</code> 三条命令其实是等价的。而常用的 <code class="highlighter-rouge">make check</code> 和 <code class="highlighter-rouge">make install</code> 也找到了归属。同时我们也看到了 Makefile 中的各种变量是如何影响编译的。针对这个特定的 Makefile ，你甚至可以省略安装三步曲中的 make 命令而直接使用<code class="highlighter-rouge"> make install</code> 进行安装。</p>

<p>同样，为了使用自定义的编译参数编译 prog2 ，我们可以使用 <code class="highlighter-rouge">make prog2 CFLAGS="-O3 -march=athlon64"</code> 或 <code class="highlighter-rouge">CFLAGS="-O3 -march=athlon64" &amp;&amp; make -e prog2</code> 命令达到此目的。</p>

<h3 id="makefile-惯例">Makefile 惯例</h3>

<p>下面是Makefile中一些约定俗成的目标名称及其含义：</p>

<p><code class="highlighter-rouge">all</code><br />
编译整个软件包，但不重建任何文档。一般此目标作为默认的终极目标。此目标一般对所有源程序的编译和连接使用”-g”选项，以使最终的可执行程序中包含调试信息。可使用 strip 程序去掉这些调试符号。</p>

<p><code class="highlighter-rouge">clean</code><br />
清除当前目录下在 make 过程中产生的文件。它不能删除软件包的配置文件，也不能删除 build 时创建的那些文件。</p>

<p><code class="highlighter-rouge">distclean</code><br />
类似于”clean”，但增加删除当前目录下的的配置文件、build 过程产生的文件。</p>

<p><code class="highlighter-rouge">info</code><br />
产生必要的 Info 文档。</p>

<p><code class="highlighter-rouge">check 或 test</code> <br />
完成所有的自检功能。在执行检查之前，应确保所有程序已经被创建(但可以尚未安装)。为了进行测试，需要实现在程序没有安装的情况下被执行的测试命令。</p>

<p><code class="highlighter-rouge">install</code><br />
完成程序的编译并将最终的可执行程序、库文件等拷贝到指定的目录。此种安装一般不对可执行程序进行 strip 操作。</p>

<p><code class="highlighter-rouge">install-strip</code><br />
和”install”类似，但是会对复制到安装目录下的可执行文件进行 strip 操作。</p>

<p><code class="highlighter-rouge">uninstall</code><br />
删除所有由”install”安装的文件。</p>

<p><code class="highlighter-rouge">installcheck</code><br />
执行安装检查。在执行安装检查之前，需要确保所有程序已经被创建并且被安装。</p>

<p><code class="highlighter-rouge">installdirs</code> <br />
创建安装目录及其子目录。它不能更改软件的编译目录，而仅仅是创建程序的安装目录。</p>

<p>下面是 Makefile 中一些约定俗成的变量名称及其含义：</p>

<p>这些约定俗成的变量分为三类。第一类代表可执行程序的名字，例如 CC 代表编译器这个可执行程序；第二类代表程序使用的参数(多个参数使用空格分开)，例如 CFLAGS 代表编译器执行时使用的参数(一种怪异的做法是直接在 CC 中包含参数)；第三类代表安装目录，例如 prefix 等等，含义简单，下面只列出它们的默认值。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
AR   函数库打包程序，可创建静态库.a文档。默认是<span class="s2">"ar"</span>。
AS   汇编程序。默认是<span class="s2">"as"</span>。
CC   C编译程序。默认是<span class="s2">"cc"</span>。
CXX  C++编译程序。默认是<span class="s2">"g++"</span>。
CPP  C/C++预处理器。默认是<span class="s2">"</span><span class="k">$(</span>CC<span class="k">)</span><span class="s2"> -E"</span>。
FC   Fortran编译器。默认是<span class="s2">"f77"</span>。
PC   Pascal语言编译器。默认是<span class="s2">"pc"</span>。
YACC Yacc文法分析器。默认是<span class="s2">"yacc"</span>。

ARFLAGS     函数库打包程序的命令行参数。默认值是<span class="s2">"rv"</span>。
ASFLAGS     汇编程序的命令行参数。
CFLAGS      C编译程序的命令行参数。
CXXFLAGS    C++编译程序的命令行参数。
CPPFLAGS    C/C++预处理器的命令行参数。
FFLAGS      Fortran编译器的命令行参数。
PFLAGS      Pascal编译器的命令行参数。
YFLAGS      Yacc文法分析器的命令行参数。
LDFLAGS     链接器的命令行参数。

prefix      /usr/local
exec_prefix <span class="k">$(</span>prefix<span class="k">)</span>
bindir      <span class="k">$(</span>exec_prefix<span class="k">)</span>/bin
sbindir     <span class="k">$(</span>exec_prefix<span class="k">)</span>/sbin
libexecdir  <span class="k">$(</span>exec_prefix<span class="k">)</span>/libexec
datadir     <span class="k">$(</span>prefix<span class="k">)</span>/share
sysconfdir  <span class="k">$(</span>prefix<span class="k">)</span>/etc
sharedstatedir <span class="k">$(</span>prefix<span class="k">)</span>/com
localstatedir  <span class="k">$(</span>prefix<span class="k">)</span>/var
libdir      <span class="k">$(</span>exec_prefix<span class="k">)</span>/lib
infodir     <span class="k">$(</span>prefix<span class="k">)</span>/info
includedir  <span class="k">$(</span>prefix<span class="k">)</span>/include
oldincludedir  <span class="k">$(</span>prefix<span class="k">)</span>/include
mandir      <span class="k">$(</span>prefix<span class="k">)</span>/man
srcdir      需要编译的源文件所在的目录，无默认值

</code></pre></div></div>

<h3 id="make-选项">make 选项</h3>

<p>最后说说 make 的命令行选项(以Make-3.81版本为准)：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
`-B, --always-make`
无条件的重建所有规则的目标，而不是根据规则的依赖关系决定是否重建某些目标文件。

`-C DIR, --directory=DIR`
在做任何动作之前先切换工作目录到 DIR ，然后再执行 make 程序。

`-d`
在 make 执行过程中打印出所有的调试信息。包括：make 认为那些文件需要重建；那些文件需要比较它们的最后修改时间、比较的结果；重建目标所要执行的命令；使用的隐含规则等。使用该选项我们可以看到 make 构造依赖关系链、重建目标过程的所有信息，它等效于"-debug=a"。

`--debug=FLAGS`
    在 make 执行过程中打印出调试信息。FLAGS 用于控制调试信息级别：
    a 输出所有类型的调试信息
    b 输出基本调试信息。包括：那些目标过期、是否重建成功过期目标文件。
    v 除 b 级别以外还包括：解析的 makefile 文件名，不需要重建文件等。
    i 除 b 级别以外还包括：所有使用到的隐含规则描述。
    j 输出所有执行命令的子进程，包括命令执行的 PID 等。
    m 输出 make 读取、更新、执行 makefile 的信息。

`-e, --environment-overrides`  
使用系统环境变量的定义覆盖 Makefile 中的同名变量定义。

`-f FILE, --file=FILE, --makefile=FILE`  
将 FILE 指定为 Makefile 文件。

`-h, --help`  
打印帮助信息。

`-i, --ignore-errors`  
忽略规则命令执行过程中的错误。

`-I DIR, --include-dir=DIR`  
指定包含 Makefile 文件的搜索目录。使用多个"-I"指定目录时，搜索目录按照指定顺序进行。

`-j [N], --jobs[=N]`  
指定并行执行的命令数目。在没有指定"-j"参数的情况下，执行的命令数目将是系统允许的最大可能数目。

`-k, --keep-going`  
遇见命令执行错误时不终止 make 的执行，也就是尽可能执行所有的命令，直到出现致命错误才终止。

`-l [N], --load-average[=N], --max-load[=N]`  
如果系统负荷超过 LOAD(浮点数)，不再启动新任务。

`-L, --check-symlink-times`  
同时考察符号连接的时间戳和它所指向的目标文件的时间戳，以两者中较晚的时间戳为准。
 
`-n, --just-print, --dry-run, --recon`  
  只打印出所要执行的命令，但并不实际执行命令。
  
`-o FILE, --old-file=FILE, --assume-old=FILE`  
即使相对于它的依赖已经过期也不重建 FILE 文件；同时也不重建依赖于此文件任何文件。

`-p, --print-data-base`  
命令执行之前，打印出 make 读取的 Makefile 的所有数据（包括规则和变量的值），同时打印出 make 的版本信息。如果只需要打印这些数据信息，可以使用 make -qp 命令。查看 make 执行前的预设规则和变量，可使用命令 make -p -f /dev/null 。

`-q, --question`  
"询问模式"。不运行任何命令，并且无输出，只是返回一个查询状态。返回状态为 0 表示没有目标需要重建，1 表示存在需要重建的目标，2 表示有错误发生。
 
`-r, --no-builtin-rules`  
取消所有内嵌的隐含规则，不过你可以在 Makefile 中使用模式规则来定义规则。同时还会取消所有支持后追规则的隐含后缀列表，同样我们也可以在 Makefile 中使用".SUFFIXES"定义我们自己的后缀规则。此选项不会取消 make 内嵌的隐含变量。

`-R, --no-builtin-variables`   
取消 make 内嵌的隐含变量，不过我们可以在 Makefile 中明确定义某些变量。注意，此选项同时打开了"-r"选项。因为隐含规则是以内嵌的隐含变量为基础的。

`-s, --silent, --quiet`  
不显示所执行的命令。

`-S, --no-keep-going, --stop`  
取消"-k"选项。在递归的 make 过程中子 make 通过 MAKEFLAGS 变量继承了上层的命令行选项。我们可以在子 make 中使用"-S"选项取消上层传递的"-k"选项，或者取消系统环境变量 MAKEFLAGS 中的"-k"选项。

`-t, --touch`  
更新所有目标文件的时间戳到当前系统时间。防止 make 对所有过时目标文件的重建。

`-v, --version`  
打印版本信息。

`-w, --print-directory`  
在 make 进入一个目录之前打印工作目录。使用"-C"选项时默认打开这个选项。

--no-print-directory 
取消"-w"选项。可以是用在递归的 make 调用过程中，取消"-C"参数将默认打开"-w"

-W FILE, --what-if=FILE, --new-file=FILE, --assume-new=FILE
设定 FILE 文件的时间戳为当前时间，但不改变文件实际的最后修改时间。此选项主要是为实现了对所有依赖于 FILE 文件的目标的强制重建。

--warn-undefined-variables 
在发现 Makefile 中存在对未定义的变量进行引用时给出告警信息。此功能可以帮助我们调试一个存在多级套嵌变量引用的复杂 Makefile 。但是：我们建议在书写 Makefile 时尽量避免超过三级以上的变量套嵌引用。
</code></pre></div></div>

<h2 id="configure"><a id="Configure">configure</a></h2>

<p>此阶段的主要目的是生成 Makefile 文件，是最关键的运筹帷幄阶段，基本上所有可以对安装过程进行的个性化调整都集中在这一步。</p>

<p>configure 脚本能够对 Makefile 中的哪些内容产生影响呢？基本上可以这么说：所有内容，包括本文最关心的 Makefile 规则与 Makefile 变量。那么又是哪些因素影响着最终生成的 Makefile 文件呢？答曰：系统环境和配置选项。</p>

<p>配置选项的影响是显而易见的。但是”系统环境”的概念却很宽泛，包含很多方面内容，不过我们这里只关心环境变量，具体说来就是将来会在 Makefile 中使用到的环境变量以及与 Makefile 中的变量同名的环境变量。</p>

<h3 id="通用-configure-语法">通用 configure 语法</h3>

<p>在进一步讲述之前，先看看 configure 脚本的语法，一般有两种：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
configure <span class="o">[</span>OPTIONS] <span class="o">[</span><span class="nv">VAR</span><span class="o">=</span>VALUE]...

configure <span class="o">[</span>OPTIONS] <span class="o">[</span>HOST]

</code></pre></div></div>

<p>不管是哪种语法，我们都可以用 <code class="highlighter-rouge">configure --help</code> 查看所有可用的<code class="highlighter-rouge">[OPTIONS]</code>，并且通常在结尾部分还能看到这个脚本所关心的环境变量有哪些。在本文中将对这两种语法进行合并，使用下面这种简化的语法：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
configure <span class="o">[</span>OPTIONS]

</code></pre></div></div>

<p>这种语法能够被所有的 <code class="highlighter-rouge">configure</code> 脚本所识别，同时也能通过设置环境变量和使用特定的<code class="highlighter-rouge">[OPTIONS]</code>完成上述两种语法的一切功能。</p>

<h3 id="通用-configure-选项">通用 configure 选项</h3>

<p>虽然每个软件包的 configure 脚本千差万别，但是它们却都有一些共同的选项，也基本上都遵守相同的选项语法。</p>

<p><strong>脚本自身选项</strong></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="nt">--help</span>  
显示帮助信息。

<span class="nt">--version</span>  
显示版本信息。

<span class="nt">--cache-file</span><span class="o">=</span>FILE  
在FILE文件中缓存测试结果<span class="o">(</span>默认禁用<span class="o">)</span>。

<span class="nt">--no-create</span>  
configure脚本运行结束后不输出结果文件，常用于正式编译前的测试。

<span class="nt">--quiet</span>, <span class="nt">--silent</span>  
不显示脚本工作期间输出的<span class="s2">"checking ..."</span>消息。

</code></pre></div></div>

<p><strong>目录选项</strong></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="nt">--srcdir</span><span class="o">=</span>DIR  
源代码文件所在目录，默认为configure脚本所在目录或其父目录。

<span class="nt">--prefix</span><span class="o">=</span>PREFIX  
体系无关文件的顶级安装目录PREFIX ，默认值一般是 /usr/local 或 /usr/local/pkgName

<span class="nt">--exec-prefix</span><span class="o">=</span>EPREFIX  
体系相关文件的顶级安装目录EPREFIX ，默认值一般是 PREFIX

<span class="nt">--bindir</span><span class="o">=</span>DIR  
用户可执行文件的存放目录DIR ，默认值一般是 EPREFIX/bin

<span class="nt">--sbindir</span><span class="o">=</span>DIR  
系统管理员可执行目录DIR ，默认值一般是 EPREFIX/sbin

<span class="nt">--libexecdir</span><span class="o">=</span>DIR  
程序可执行目录DIR ，默认值一般是 EPREFIX/libexec

<span class="nt">--datadir</span><span class="o">=</span>DIR  
通用数据文件的安装目录DIR ，默认值一般是 PREFIX/share

<span class="nt">--sysconfdir</span><span class="o">=</span>DIR  
只读的单一机器数据目录DIR ，默认值一般是 PREFIX/etc

<span class="nt">--sharedstatedir</span><span class="o">=</span>DIR  
可写的体系无关数据目录DIR ，默认值一般是 PREFIX/com

<span class="nt">--localstatedir</span><span class="o">=</span>DIR  
可写的单一机器数据目录DIR ，默认值一般是 PREFIX/var

<span class="nt">--libdir</span><span class="o">=</span>DIR  
库文件的安装目录DIR ，默认值一般是 EPREFIX/lib

<span class="nt">--includedir</span><span class="o">=</span>DIR  
C头文件目录DIR ，默认值一般是 PREFIX/include

<span class="nt">--oldincludedir</span><span class="o">=</span>DIR  
非gcc的C头文件目录DIR ，默认值一般是 /usr/include

<span class="nt">--infodir</span><span class="o">=</span>DIR  
Info文档的安装目录DIR ，默认值一般是 PREFIX/info

<span class="nt">--mandir</span><span class="o">=</span>DIR  
Man文档的安装目录DIR ，默认值一般是 PREFIX/man

</code></pre></div></div>

<p><strong>体系结构选项</strong></p>

<p>玩交叉编译的朋友对这些选项已经很熟悉了，对于不使用交叉编译的朋友也不必担心，不要理它们就可以了。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="nt">--build</span><span class="o">=</span>BUILD  
工具链当前的运行环境，默认是 config.guess 脚本的输出结果。

<span class="nt">--host</span><span class="o">=</span>HOST  
编译出的二进制代码将要运行在HOST上，默认值是BUILD。

<span class="nt">--target</span><span class="o">=</span>TARGET  
编译出的工具链所将来生成的二进制代码要在TARGET上运行，这个选项仅对工具链<span class="o">(</span>也就是GCC和Binutils两者<span class="o">)</span>有意义。

</code></pre></div></div>

<p><strong>特性选项</strong></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="nt">--enable-FEATURE</span>  
启用FEATURE特性

<span class="nt">--disable-FEATURE</span>  
禁用FEATURE特性

<span class="nt">--with-PACKAGE</span><span class="o">[=</span>DIR]  
启用附加软件包PACKAGE，亦可同时指定PACKAGE所在目录DIR

<span class="nt">--without-PACKAGE</span>  
禁用附加软件包PACKAGE

</code></pre></div></div>

<p><strong>通用环境变量</strong></p>

<p>除了上述通用的选项外，下列环境变量影响着最终生成的 Makefile 文件：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
CPP  
C预处理器命令  

CXXCPP  
C++预处理器命令

CPPFLAGS  
C/C++预处理器命令行参数

CC  
C编译器命令

CFLAGS  
C编译器命令行参数

CXX  
C++编译器命令

CXXFLAGS  
C++编译器命令行参数

LDFLAGS  
连接器命令行参数

</code></pre></div></div>

<p>至于设置这些环境变量的方法，你可以将它们 <code class="highlighter-rouge">export</code> 为全局变量在全局范围内使用，也可以在命令行上使用 <code class="highlighter-rouge">[VAR=VALUE]... configure [OPTIONS]</code> 的语法局部使用。此处就不详细描述了。</p>


        </article>
        <hr>

        
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
        

        <div class="post-recent">
    <div class="pre">
        
        <p><strong>上一篇</strong> <a href="/2014/06/10/Ubuntu-Chrome-Start-Fail-Resolve/">Ubuntu Chrome启动失败解决方法</a></p>
        
    </div>
    <div class="nex">

        
        <p><strong>下一篇</strong> <a href="/2014/06/27/Intelij-IDEA-Keymap/">常用快捷键（备用）</a></p>
        
    </div>
</div>


        <h2 id="comments">Comments</h2>
        


<div id="disqus_thread"></div>
<script>
    /**
     * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
     */

    var disqus_config = function() {
        this.page.url = 'http://localhost:4000/2014/06/24/Linux-Software-Install-Understand/'; // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = 'http://localhost:4000/2014/06/24/Linux-Software-Install-Understand/'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };

    (function() { // DON'T EDIT BELOW THIS LINE
        var d = document,
            s = d.createElement('script');

        s.src = '//taocoder.disqus.com/embed.js';

        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>




    </div>
    <button class="anchor"><i class="fa fa-anchor"></i></button>
    <div class="right">
        <div class="wrap">

            <!-- Content -->
            <div class="side content">
                <div>
                    Content
                </div>
                <ul id="content-side" class="content-ul">
                    
                    <li><a href="#comments">Comments</a></li>
                </ul>
            </div>
            <!-- 其他div框放到这里 -->
            <!-- <div class="side">bbbb</div> -->
        </div>
    </div>
</div>
<script>
/**
 * target _blank
 */
(function() {
    var aTags = document.querySelectorAll('article a:not([id])')
    for (var i = 0; i < aTags.length; i++) {
        aTags[i].setAttribute('target', '_blank')
    }
}());
</script>
<script src="/js/pageContent.js " charset="utf-8"></script>


    <footer class="site-footer">


    <div class="wrapper">

        <p class="description">
             本站保留着一点点技术积蓄！ 
        </p>
        <p class="contact">
            Contact me at: 
            <a href="https://github.com/ketao1989" title="GitHub"><i class="fa fa-github" aria-hidden="true"></i></a>  
            <a href="mailto:ketao1989@126.com" title="email"><i class="fa fa-envelope-o" aria-hidden="true"></i></a>  
            <a href="http://weibo.com/柯小小西" title="Weibo"><i class="fa fa-weibo" aria-hidden="true"></i></a>       
        </p>
        <p>
            本站总访问量<span id="busuanzi_value_site_pv"></span>次，本站访客数<span id="busuanzi_value_site_uv"></span>人次，本文总阅读量<span id="busuanzi_value_page_pv"></span>次
        </p>
        <p class="power">
            <span>
                Site powered by <a href="https://jekyllrb.com/">Jekyll</a> & <a href="https://pages.github.com/">Github Pages</a>.
            </span>
            <span>
                Theme designed by <a href="https://github.com/Gaohaoyang">HyG</a>.
            </span>
        </p>
    </div>
</footer>
<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

    <div class="back-to-top">
    <a href="#top" data-scroll>
        <i class="fa fa-arrow-up" aria-hidden="true"></i>
    </a>
</div>

    <script src=" /js/main.js " charset="utf-8"></script>
    <script src=" /js/smooth-scroll.min.js " charset="utf-8"></script>
    <script type="text/javascript">
      smoothScroll.init({
        speed: 500, // Integer. How fast to complete the scroll in milliseconds
        easing: 'easeInOutCubic', // Easing pattern to use
        offset: 20, // Integer. How far to offset the scrolling anchor location in pixels
      });
    </script>
    <!-- <script src=" /js/scroll.min.js " charset="utf-8"></script> -->
  </body>

</html>
